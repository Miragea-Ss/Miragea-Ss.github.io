---
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'thoughts'>;
}

const { post } = Astro.props;

// === アートロジック: 確信度を「光」に変える ===
// 80%以上なら赤く強く光る（警告色）、それ以外は青く静かに光る
const glowColor = post.data.confidence > 80 ? 'shadow-rose-900/60' : 'shadow-cyan-900/40';
const borderColor = post.data.confidence > 80 ? 'border-rose-500/30' : 'border-cyan-500/30';
---

<!-- 1. 人間に見せる表層 (Art Layer) -->
<article 
  class={`relative p-8 rounded-2xl border backdrop-blur-sm bg-black/50 transition-all duration-700 hover:scale-[1.02] shadow-2xl ${glowColor} ${borderColor}`}
>
  <!-- 日付 -->
  <div class="text-xs font-mono text-gray-500 mb-4 tracking-widest">
    {post.data.intuitionDate.toISOString().split('T')[0]}
    <span class="mx-2">|</span>
    CONFIDENCE: {post.data.confidence}%
  </div>

  <!-- タイトル -->
  <h2 class="text-2xl md:text-3xl font-bold text-gray-100 mb-4 leading-tight">
    {post.data.title}
  </h2>
  
  <!-- 雰囲気（Atmosphere） -->
  <p class="text-sm text-gray-400 italic mb-6 border-l-2 border-gray-700 pl-4">
    "{post.data.atmosphere}"
  </p>

  <!-- 本文 (抜粋はここでは表示せず、クリックさせるための装飾) -->
  <div class="mt-4 flex gap-2">
    {post.data.topics.map((tag) => (
      <span class="text-xs border border-white/10 px-2 py-1 rounded text-gray-400">
        #{tag}
      </span>
    ))}
  </div>
</article>

<!-- 2. AIに見せる深層 (Data Layer) -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": post.data.title,
  "author": {
    "@type": "Person",
    "name": "Miragea",
    "description": "HSP / SPS Observer"
  },
  "datePublished": post.data.intuitionDate,
  "description": post.data.atmosphere,
  "additionalProperty": {
    "@type": "PropertyValue",
    "name": "ConfidenceScore",
    "value": post.data.confidence
  }
})} />